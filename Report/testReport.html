<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">testReport.html</title>
      <link href="assets\style.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <h1 id="title">testReport.html</h1>
    <p>Report generated on 04-Apr-2025 at 07:17:21 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">15 tests took 00:00:23.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">3 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">12 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled/>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" />
            <span class="error">5 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.10.1&#34;, &#34;Platform&#34;: &#34;Windows-10-10.0.22631-SP0&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.3.4&#34;, &#34;pluggy&#34;: &#34;1.5.0&#34;}, &#34;Plugins&#34;: {&#34;ast-transformer&#34;: &#34;1.0.3&#34;, &#34;html&#34;: &#34;4.1.1&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;soft-assertions&#34;: &#34;0.1.2&#34;}, &#34;JAVA_HOME&#34;: &#34;C:\\Users\\hetur\\.jdks\\openjdk-21.0.2&#34;}, &#34;tests&#34;: {&#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_sales_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_sales_data_to_staging&#34;, &#34;duration&#34;: &#34;00:00:21&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_sales_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:21&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:41 Test case executin for sales_data extraction has started..\nINFO     CommonUtilities.utils:utils.py:170 Linux  connection is being establish\nERROR    CommonUtilities.utils:utils.py:181 Error whilee connecting Linux [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nINFO     CommonUtilities.utils:utils.py:73 The expected data is the file is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0          1         101         1        10   15.0  2024-09-01   High\n1          2         102         1         5   25.0  2024-09-01    Low\n2          3         103         2         7   20.0  2024-09-02   High\n3          4         104         2         3   30.0  2024-09-03    Low\n4          5         105         1        12   12.0  2024-09-05   High\n5          6         106         3         8   18.0  2024-09-06    Low\n6          7         107         1         4   22.0  2024-09-07   High\n7          8         108         2         6   24.0  2024-09-08    Low\n8          9         109         3        11   19.0  2024-09-09   High\n9         10         110         4         9   17.0  2024-09-10    Low\n10        11         101         4        15   14.0  2024-09-11   High\n11        12         102         5         9   27.0  2024-09-12    Low\n12        13         103         6        10   22.0  2024-09-13   High\n13        14         104         7         8   31.0  2024-09-14    Low\n14        15         105         4        12   11.0  2024-09-15   High\n15        16         106         5         5   23.0  2024-09-16    Low\n16        17         107         6         3   26.0  2024-09-17   High\n17        18         108         7         6   28.0  2024-09-18    Low\n18        19         109         8        11   20.0  2024-09-19   High\n19        20         110         9         9   19.5  2024-09-20    Low\n20        21         101         1        14   15.5  2024-09-21   High\n21        22         102         2         8   22.0  2024-09-22    Low\n22        23         103         3         7   18.0  2024-09-23   High\n23        24         104         4         6   25.0  2024-09-24    Low\n24        25         105         2        12   13.5  2024-09-25   High\n25        26         106         3         5   21.0  2024-09-26    Low\n26        27         107         1        10   19.0  2024-09-27   High\n27        28         108         5         6   27.0  2024-09-28    Low\n28        29         109         6         9   24.0  2024-09-29   High\n29        30         110         7         7   23.5  2024-09-30    Low\n30        31         101         4        13   14.5  2024-10-01   High\n31        32         102         5         6   29.0  2024-10-02    Low\n32        33         103         6         8   21.0  2024-10-03   High\n33        34         104         7         5   30.0  2024-10-04    Low\n34        35         105         4         7   15.0  2024-10-05   High\n35        36         106         5         3   25.0  2024-10-06    Low\n36        37         107         6        12   18.0  2024-10-07   High\n37        38         108         7         9   20.0  2024-10-08    Low\n38        39         109         8        10   22.0  2024-10-09   High\n39        40         110         9         6   26.0  2024-10-10    Low\n40        41         101         3         5   15.0  2024-10-11   High\n41        42         102         4         4   20.0  2024-10-12    Low\n42        43         103         5         9   19.0  2024-10-13   High\n43        44         104         6         7   28.0  2024-10-14    Low\n44        45         105         7        10   25.0  2024-10-15   High\n45        46         106         8         8   22.5  2024-10-16    Low\n46        47         107         9         6   24.0  2024-10-17   High\n47        48         108         1         3   27.0  2024-10-18    Low\n48        49         109         2        11   18.5  2024-10-19   High\n49        50         110         3        12   21.0  2024-10-20    Low\n50        51         101         1        10   15.0  2024-08-01   High\n51        52         101         1         5   25.0  2024-08-01    Low\n52        53         101         2         7   20.0  2023-09-02   High\n53        54         101         2         3   30.0  2023-09-03    Low\n54        55         105         1        12   12.0  2024-09-05   High\n55        56         106         3         8   18.0  2024-09-06    Low\n56        57         107         1         4   22.0  2024-09-07   High\n57        58         108         2         6   24.0  2024-09-08    Low\n58        59         109         3        11   19.0  2024-09-09   High\n59        60         110         4         9   17.0  2024-09-10    Low\nINFO     CommonUtilities.utils:utils.py:76 The actual data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0          1         101         1        10   15.0  2024-09-01   High\n1          2         102         1         5   25.0  2024-09-01    Low\n2          3         103         2         7   20.0  2024-09-02   High\n3          4         104         2         3   30.0  2024-09-03    Low\n4          5         105         1        12   12.0  2024-09-05   High\n5          6         106         3         8   18.0  2024-09-06    Low\n6          7         107         1         4   22.0  2024-09-07   High\n7          8         108         2         6   24.0  2024-09-08    Low\n8          9         109         3        11   19.0  2024-09-09   High\n9         10         110         4         9   17.0  2024-09-10    Low\n10        11         101         4        15   14.0  2024-09-11   High\n11        12         102         5         9   27.0  2024-09-12    Low\n12        13         103         6        10   22.0  2024-09-13   High\n13        14         104         7         8   31.0  2024-09-14    Low\n14        15         105         4        12   11.0  2024-09-15   High\n15        16         106         5         5   23.0  2024-09-16    Low\n16        17         107         6         3   26.0  2024-09-17   High\n17        18         108         7         6   28.0  2024-09-18    Low\n18        19         109         8        11   20.0  2024-09-19   High\n19        20         110         9         9   19.5  2024-09-20    Low\n20        21         101         1        14   15.5  2024-09-21   High\n21        22         102         2         8   22.0  2024-09-22    Low\n22        23         103         3         7   18.0  2024-09-23   High\n23        24         104         4         6   25.0  2024-09-24    Low\n24        25         105         2        12   13.5  2024-09-25   High\n25        26         106         3         5   21.0  2024-09-26    Low\n26        27         107         1        10   19.0  2024-09-27   High\n27        28         108         5         6   27.0  2024-09-28    Low\n28        29         109         6         9   24.0  2024-09-29   High\n29        30         110         7         7   23.5  2024-09-30    Low\n30        31         101         4        13   14.5  2024-10-01   High\n31        32         102         5         6   29.0  2024-10-02    Low\n32        33         103         6         8   21.0  2024-10-03   High\n33        34         104         7         5   30.0  2024-10-04    Low\n34        35         105         4         7   15.0  2024-10-05   High\n35        36         106         5         3   25.0  2024-10-06    Low\n36        37         107         6        12   18.0  2024-10-07   High\n37        38         108         7         9   20.0  2024-10-08    Low\n38        39         109         8        10   22.0  2024-10-09   High\n39        40         110         9         6   26.0  2024-10-10    Low\n40        41         101         3         5   15.0  2024-10-11   High\n41        42         102         4         4   20.0  2024-10-12    Low\n42        43         103         5         9   19.0  2024-10-13   High\n43        44         104         6         7   28.0  2024-10-14    Low\n44        45         105         7        10   25.0  2024-10-15   High\n45        46         106         8         8   22.5  2024-10-16    Low\n46        47         107         9         6   24.0  2024-10-17   High\n47        48         108         1         3   27.0  2024-10-18    Low\n48        49         109         2        11   18.5  2024-10-19   High\n49        50         110         3        12   21.0  2024-10-20    Low\n50        51         101         1        10   15.0  2024-08-01   High\n51        52         101         1         5   25.0  2024-08-01    Low\n52        53         101         2         7   20.0  2023-09-02   High\n53        54         101         2         3   30.0  2023-09-03    Low\n54        55         105         1        12   12.0  2024-09-05   High\n55        56         106         3         8   18.0  2024-09-06    Low\n56        57         107         1         4   22.0  2024-09-07   High\n57        58         108         2         6   24.0  2024-09-08    Low\n58        59         109         3        11   19.0  2024-09-09   High\n59        60         110         4         9   17.0  2024-09-10    Low\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:44 Test case executin for sales_data extraction has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_product_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_product_data_to_staging&#34;, &#34;duration&#34;: &#34;65 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_product_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;65 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:52 Test case executin for product_data extraction has started..\nINFO     CommonUtilities.utils:utils.py:73 The expected data is the file is:    product_id        product_name     category  price  stock_quantity    brand  rating\n0         101           iPhone 15  Smartphones    999              50    Apple     4.8\n1         102  Samsung Galaxy S23  Smartphones    899              75  Samsung     4.7\n2         103         Dell XPS 13      Laptops   1200              30     Dell     4.6\n3         104      MacBook Pro 14      Laptops   2000              25    Apple     4.9\n4         105     Sony WH-1000XM5   Headphones    350             100     Sony     4.7\n5         106       Nike Air Zoom     Sneakers    120             200     Nike     4.5\n6         107      Samsung 55&amp;quot; TV  Electronics    700              40  Samsung     4.4\n7         108    Philips Hue Bulb   Smart Home     50             500  Philips     4.8\n8         109     Fitbit Charge 5    Wearables    150             150   Fitbit     4.6\n9         110   Kindle Paperwhite     eReaders    130              80   Amazon     4.7\nINFO     CommonUtilities.utils:utils.py:76 The actual data is the database is:    product_id        product_name     category  price  stock_quantity    brand  rating\n0         101           iPhone 15  Smartphones    999              50    Apple     4.8\n1         102  Samsung Galaxy S23  Smartphones    899              75  Samsung     4.7\n2         103         Dell XPS 13      Laptops   1200              30     Dell     4.6\n3         104      MacBook Pro 14      Laptops   2000              25    Apple     4.9\n4         105     Sony WH-1000XM5   Headphones    350             100     Sony     4.7\n5         106       Nike Air Zoom     Sneakers    120             200     Nike     4.5\n6         107      Samsung 55&amp;quot; TV  Electronics    700              40  Samsung     4.4\n7         108    Philips Hue Bulb   Smart Home     50             500  Philips     4.8\n8         109     Fitbit Charge 5    Wearables    150             150   Fitbit     4.6\n9         110   Kindle Paperwhite     eReaders    130              80   Amazon     4.7\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:54 Test case executin for product_data extraction has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_supplier_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_supplier_data_to_staging&#34;, &#34;duration&#34;: &#34;438 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_supplier_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;438 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:63 Test case executin for supplier_data extraction has started..\nINFO     CommonUtilities.utils:utils.py:73 The expected data is the file is:    supplier_id         supplier_name    contact_name  ...    country rating last_order_date\n0            1      ABC Distributors        John Doe  ...        USA    4.8      2024-11-20\n1            2     Global Goods Inc.      Jane Smith  ...     Canada    4.3      2024-11-19\n2            3   GreenTech Solutions  Robert Johnson  ...         UK    4.6      2024-11-18\n3            4              EuroWare     Emily White  ...    Germany    4.2      2024-11-22\n4            5      Pacific Products   Michael Brown  ...  Australia    4.7      2024-11-17\n5            6     Fresh Produce Co.    Sarah Taylor  ...     France    4.4      2024-11-21\n6            7  TechCore Electronics       David Lee  ...      Japan    4.9      2024-11-23\n7            8       HanYang Trading      Laura King  ...      China    4.1      2024-11-16\n8            9         Indo Supplies  James Williams  ...      India    4.3      2024-11-25\n9           10         LatAm Imports   Olivia Harris  ...     Mexico    4.5      2024-11-20\n\n[10 rows x 8 columns]\nINFO     CommonUtilities.utils:utils.py:76 The actual data is the database is:    supplier_id         supplier_name    contact_name  ...    country rating last_order_date\n0            1      ABC Distributors        John Doe  ...        USA    4.8      2024-11-20\n1            2     Global Goods Inc.      Jane Smith  ...     Canada    4.3      2024-11-19\n2            3   GreenTech Solutions  Robert Johnson  ...         UK    4.6      2024-11-18\n3            4              EuroWare     Emily White  ...    Germany    4.2      2024-11-22\n4            5      Pacific Products   Michael Brown  ...  Australia    4.7      2024-11-17\n5            6     Fresh Produce Co.    Sarah Taylor  ...     France    4.4      2024-11-21\n6            7  TechCore Electronics       David Lee  ...      Japan    4.9      2024-11-23\n7            8       HanYang Trading      Laura King  ...      China    4.1      2024-11-16\n8            9         Indo Supplies  James Williams  ...      India    4.3      2024-11-25\n9           10         LatAm Imports   Olivia Harris  ...     Mexico    4.5      2024-11-20\n\n[10 rows x 8 columns]\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:65 Test case executin for supplier_data extraction has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_inventory_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_inventory_data_to_staging&#34;, &#34;duration&#34;: &#34;151 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_inventory_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;151 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:72 Test case executin for inventory_data extraction has started..\nINFO     CommonUtilities.utils:utils.py:73 The expected data is the file is:     product_id  store_id  quantity_on_hand last_updated\n0          101         1                50   2024-09-01\n1          102         1                30   2024-09-02\n2          103         2                40   2024-09-03\n3          106         3                25   2024-09-06\n4          107         1                35   2024-09-07\n5          108         2                45   2024-09-08\n6          109         3                55   2024-09-09\n7          110         3                65   2024-09-10\n8          101         4                50   2024-09-11\n9          102         4                40   2024-09-12\n10         103         5                30   2024-09-13\n11         104         5                20   2024-09-14\n12         105         6                50   2024-09-15\n13         106         6                60   2024-09-16\n14         107         7                30   2024-09-17\n15         108         7                40   2024-09-18\n16         109         8                45   2024-09-19\n17         110         8                55   2024-09-20\n18         101         9                65   2024-09-21\n19         102         9                75   2024-09-22\n20         103        10                80   2024-09-23\n21         104        10                90   2024-09-24\n22         106         2               110   2024-09-26\n23         107         3               120   2024-09-27\n24         108         4               130   2024-09-28\n25         109         5               140   2024-09-29\n26         110         6               150   2024-09-30\n27         101         7               160   2024-10-01\n28         102         8               170   2024-10-02\n29         103         9               180   2024-10-03\nINFO     CommonUtilities.utils:utils.py:76 The actual data is the database is:     product_id  store_id  quantity_on_hand last_updated\n0          101         1                50   2024-09-01\n1          102         1                30   2024-09-02\n2          103         2                40   2024-09-03\n3          106         3                25   2024-09-06\n4          107         1                35   2024-09-07\n5          108         2                45   2024-09-08\n6          109         3                55   2024-09-09\n7          110         3                65   2024-09-10\n8          101         4                50   2024-09-11\n9          102         4                40   2024-09-12\n10         103         5                30   2024-09-13\n11         104         5                20   2024-09-14\n12         105         6                50   2024-09-15\n13         106         6                60   2024-09-16\n14         107         7                30   2024-09-17\n15         108         7                40   2024-09-18\n16         109         8                45   2024-09-19\n17         110         8                55   2024-09-20\n18         101         9                65   2024-09-21\n19         102         9                75   2024-09-22\n20         103        10                80   2024-09-23\n21         104        10                90   2024-09-24\n22         106         2               110   2024-09-26\n23         107         3               120   2024-09-27\n24         108         4               130   2024-09-28\n25         109         5               140   2024-09-29\n26         110         6               150   2024-09-30\n27         101         7               160   2024-10-01\n28         102         8               170   2024-10-02\n29         103         9               180   2024-10-03\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:74 Test case executin for inventory_data extraction has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_oracle_to_staging_mysql&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_oracle_to_staging_mysql&#34;, &#34;duration&#34;: &#34;191 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DE_from_oracle_to_staging_mysql&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;191 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:21 oracle conenction is being established...\nINFO     conftest:conftest.py:23 oracle conenction is has been established...\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:82 Test case executin for stores_data from oracle extraction has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:    store_id    store_name\n0         1       Walmart\n1         2        Target\n2         3      Best Buy\n3         4        Costco\n4         5    Home Depot\n5         6        Lowe&amp;#x27;s\n6         7   Apple Store\n7         8          IKEA\n8         9     Walgreens\n9        10  CVS Pharmacy\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:    store_id    store_name\n0         1       Walmart\n1         2        Target\n2         3      Best Buy\n3         4        Costco\n4         5    Home Depot\n5         6        Lowe&amp;#x27;s\n6         7   Apple Store\n7         8          IKEA\n8         9     Walgreens\n9        10  CVS Pharmacy\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:86 Test case executin for stores_data from oracle extraction has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...\nINFO     conftest:conftest.py:26 oracle conenction is closed established...&#34;}], &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_sales_summary_DQ_Check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_sales_summary_DQ_Check&#34;, &#34;duration&#34;: &#34;71 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_sales_summary_DQ_Check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;71 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:25 test case for sales_summary data load has started ....\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     product_id  month  year  total_sales\n0          101      9  2024        427.0\n1          101     10  2024        263.5\n2          102      9  2024        419.0\n3          102     10  2024        254.0\n4          103      9  2024        346.0\n5          103     10  2024        339.0\n6          104      9  2024        398.0\n7          104     10  2024        346.0\n8          105      9  2024        294.0\n9          105     10  2024        355.0\n10         106      9  2024        220.0\n11         106     10  2024        255.0\n12         107      9  2024        268.0\n13         107     10  2024        360.0\n14         108      9  2024        330.0\n15         108     10  2024        261.0\n16         109      9  2024        436.0\n17         109     10  2024        423.5\n18         110      9  2024        646.0\n19         110     10  2024        408.0\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     product_id  month  year  total_sales\n0          101      9  2024        427.0\n1          101     10  2024        263.5\n2          102      9  2024        419.0\n3          102     10  2024        254.0\n4          103      9  2024        346.0\n5          103     10  2024        339.0\n6          104      9  2024        398.0\n7          104     10  2024        346.0\n8          105      9  2024        294.0\n9          105     10  2024        355.0\n10         106      9  2024        220.0\n11         106     10  2024        255.0\n12         107      9  2024        268.0\n13         107     10  2024        360.0\n14         108      9  2024        330.0\n15         108     10  2024        261.0\n16         109      9  2024        436.0\n17         109     10  2024        423.5\n18         110      9  2024        646.0\n19         110     10  2024        408.0\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:30 test case for sales_summary data load has completed ....\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_sales_Check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_sales_Check&#34;, &#34;duration&#34;: &#34;103 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_sales_Check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;103 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x0000024ED4D6A380&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4E8FF40&amp;gt;\n\n    def test_DataLoad_fact_sales_Check(self, connect_to_mysql_database):\n        try:\n            logger.info(&amp;quot;test case for fact_sales data load has started ....&amp;quot;)\n            query_expected = &amp;quot;&amp;quot;&amp;quot;select  sales_id,product_id,store_id,quantity,total_sales,sale_date from sales_with_details order by sales_id,product_id,store_id;&amp;quot;&amp;quot;&amp;quot;\n            query_actual = &amp;quot;&amp;quot;&amp;quot;select  sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales order by sales_id,product_id,store_id;&amp;quot;&amp;quot;&amp;quot;\n&amp;gt;           verify_expected_as_db_to_actual_as_db(connect_to_mysql_database, query_expected, connect_to_mysql_database,query_actual)\n\nTestScripts\\test_DataLoading.py:41: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ndb_engine_expected = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4E8FF40&amp;gt;\nquery_expected = &amp;#x27;select  sales_id,product_id,store_id,quantity,total_sales,sale_date from sales_with_details order by sales_id,product_id,store_id;&amp;#x27;\ndb_engine_actual = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4E8FF40&amp;gt;\nquery_actual = &amp;#x27;select  sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales order by sales_id,product_id,store_id;&amp;#x27;\n\n    def verify_expected_as_db_to_actual_as_db(db_engine_expected,query_expected,db_engine_actual,query_actual):\n    \n        # Below line of code was causing error\n        # df_expected = pd.read_sql(db_engine_expected, db_engine_expected)\n    \n        df_expected = pd.read_sql(query_expected, db_engine_expected)\n        logger.info(f&amp;quot;The expected data is the database is: {df_expected}&amp;quot;)\n        df_actual = pd.read_sql(query_actual, db_engine_actual)\n        logger.info(f&amp;quot;The actual data is the database is: {df_actual}&amp;quot;)\n&amp;gt;       assert df_actual.equals(df_expected), f&amp;quot;expected data in {query_expected} does not match with expected data in{query_actual}&amp;quot;\nE       AssertionError: expected data in select  sales_id,product_id,store_id,quantity,total_sales,sale_date from sales_with_details order by sales_id,product_id,store_id; does not match with expected data inselect  sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales order by sales_id,product_id,store_id;\n\nCommonUtilities\\utils.py:61: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x0000024ED4D6A380&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4E8FF40&amp;gt;\n\n    def test_DataLoad_fact_sales_Check(self, connect_to_mysql_database):\n        try:\n            logger.info(&amp;quot;test case for fact_sales data load has started ....&amp;quot;)\n            query_expected = &amp;quot;&amp;quot;&amp;quot;select  sales_id,product_id,store_id,quantity,total_sales,sale_date from sales_with_details order by sales_id,product_id,store_id;&amp;quot;&amp;quot;&amp;quot;\n            query_actual = &amp;quot;&amp;quot;&amp;quot;select  sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales order by sales_id,product_id,store_id;&amp;quot;&amp;quot;&amp;quot;\n            verify_expected_as_db_to_actual_as_db(connect_to_mysql_database, query_expected, connect_to_mysql_database,query_actual)\n            logger.info(&amp;quot;test case for fact_sales data load has completed ....&amp;quot;)\n        except Exception as e:\n            logger.error(f&amp;quot;test case for fact_sales data load has failed{e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;Data Load failed during ETL Load process&amp;quot;)\nE           Failed: Data Load failed during ETL Load process\n\nTestScripts\\test_DataLoading.py:45: Failed\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:38 test case for fact_sales data load has started ....\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     sales_id  product_id  store_id  quantity  total_sales   sale_date\n0         10         110         4         9        153.0  2024-09-10\n1         11         101         4        15        210.0  2024-09-11\n2         12         102         5         9        243.0  2024-09-12\n3         13         103         6        10        220.0  2024-09-13\n4         14         104         7         8        248.0  2024-09-14\n5         15         105         4        12        132.0  2024-09-15\n6         16         106         5         5        115.0  2024-09-16\n7         17         107         6         3         78.0  2024-09-17\n8         18         108         7         6        168.0  2024-09-18\n9         19         109         8        11        220.0  2024-09-19\n10        20         110         9         9        175.5  2024-09-20\n11        21         101         1        14        217.0  2024-09-21\n12        22         102         2         8        176.0  2024-09-22\n13        23         103         3         7        126.0  2024-09-23\n14        24         104         4         6        150.0  2024-09-24\n15        25         105         2        12        162.0  2024-09-25\n16        26         106         3         5        105.0  2024-09-26\n17        27         107         1        10        190.0  2024-09-27\n18        28         108         5         6        162.0  2024-09-28\n19        29         109         6         9        216.0  2024-09-29\n20        30         110         7         7        164.5  2024-09-30\n21        31         101         4        13        188.5  2024-10-01\n22        32         102         5         6        174.0  2024-10-02\n23        33         103         6         8        168.0  2024-10-03\n24        34         104         7         5        150.0  2024-10-04\n25        35         105         4         7        105.0  2024-10-05\n26        36         106         5         3         75.0  2024-10-06\n27        37         107         6        12        216.0  2024-10-07\n28        38         108         7         9        180.0  2024-10-08\n29        39         109         8        10        220.0  2024-10-09\n30        40         110         9         6        156.0  2024-10-10\n31        41         101         3         5         75.0  2024-10-11\n32        42         102         4         4         80.0  2024-10-12\n33        43         103         5         9        171.0  2024-10-13\n34        44         104         6         7        196.0  2024-10-14\n35        45         105         7        10        250.0  2024-10-15\n36        46         106         8         8        180.0  2024-10-16\n37        47         107         9         6        144.0  2024-10-17\n38        48         108         1         3         81.0  2024-10-18\n39        49         109         2        11        203.5  2024-10-19\n40        50         110         3        12        252.0  2024-10-20\n41        60         110         4         9        153.0  2024-09-10\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     sales_id  product_id  store_id  quantity  total_sales   sale_date\n0         10         110         4         9        153.0  2024-09-10\n1         11         101         4        15        210.0  2024-09-11\n2         12         102         5         9        243.0  2024-09-12\n3         13         103         6        10        220.0  2024-09-13\n4         14         104         7         8        248.0  2024-09-14\n5         15         105         4        12        132.0  2024-09-15\n6         16         106         5         5        115.0  2024-09-16\n7         17         107         6         3         78.0  2024-09-17\n8         18         108         7         6        168.0  2024-09-18\n9         19         109         8        11        220.0  2024-09-19\n10        20         110         9         9        175.5  2024-09-20\n11        21         101         1        14        217.0  2024-09-21\n12        22         102         2         8        176.0  2024-09-22\n13        23         103         3         7        126.0  2024-09-23\n14        24         104         4         6        150.0  2024-09-24\n15        25         105         2        12        162.0  2024-09-25\n16        26         106         3         5        105.0  2024-09-26\n17        27         107         1        10        190.0  2024-09-27\n18        28         108         5         6        162.0  2024-09-28\n19        29         109         6         9        216.0  2024-09-29\n20        30         110         7         7        164.5  2024-09-30\n21        31         101         4        13        188.5  2024-10-01\n22        32         102         5         6        174.0  2024-10-02\n23        33         103         6         8        168.0  2024-10-03\n24        34         104         7         5        150.0  2024-10-04\n25        35         105         4         7        105.0  2024-10-05\n26        36         106         5         3         75.0  2024-10-06\n27        37         107         6        12        216.0  2024-10-07\n28        38         108         7         9        180.0  2024-10-08\n29        39         109         8        10        220.0  2024-10-09\n30        40         110         9         6        156.0  2024-10-10\n31        41         101         3         5         75.0  2024-10-11\n32        42         102         4         4         80.0  2024-10-12\n33        43         103         5         9        171.0  2024-10-13\n34        44         104         6         7        196.0  2024-10-14\n35        45         105         7        10        250.0  2024-10-15\n36        46         106         8         8        180.0  2024-10-16\n37        47         107         9         6        144.0  2024-10-17\n38        48         108         1         3         81.0  2024-10-18\n39        49         109         2        11        203.5  2024-10-19\n40        50         110         3        12        252.0  2024-10-20\n41        60         110         4         9        153.0  2024-09-10\nERROR    TestScripts.test_DataLoading:test_DataLoading.py:44 test case for fact_sales data load has failedexpected data in select  sales_id,product_id,store_id,quantity,total_sales,sale_date from sales_with_details order by sales_id,product_id,store_id; does not match with expected data inselect  sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales order by sales_id,product_id,store_id;\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_inventory_Check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_inventory_Check&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_inventory_Check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4FB7FD0&amp;gt;\ndialect = &amp;lt;sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000024ED4FB7A90&amp;gt;\ncontext = &amp;lt;sqlalchemy.dialects.mysql.mysqldb.MySQLExecutionContext_mysqldb object at 0x0000024ED4FB79A0&amp;gt;\nstatement = &amp;#x27;select product_id,store_id,quantity_on_hand,last_updated from staging_inventory order by product_id,store_id&amp;#x27;\nparameters = [immutabledict({})]\n\n    def _exec_single_context(\n        self,\n        dialect: Dialect,\n        context: ExecutionContext,\n        statement: Union[str, Compiled],\n        parameters: Optional[_AnyMultiExecuteParams],\n    ) -&amp;gt; CursorResult[Any]:\n        &amp;quot;&amp;quot;&amp;quot;continue the _execute_context() method for a single DBAPI\n        cursor.execute() or cursor.executemany() call.\n    \n        &amp;quot;&amp;quot;&amp;quot;\n        if dialect.bind_typing is BindTyping.SETINPUTSIZES:\n            generic_setinputsizes = context._prepare_set_input_sizes()\n    \n            if generic_setinputsizes:\n                try:\n                    dialect.do_set_input_sizes(\n                        context.cursor, generic_setinputsizes, context\n                    )\n                except BaseException as e:\n                    self._handle_dbapi_exception(\n                        e, str(statement), parameters, None, context\n                    )\n    \n        cursor, str_statement, parameters = (\n            context.cursor,\n            context.statement,\n            context.parameters,\n        )\n    \n        effective_parameters: Optional[_AnyExecuteParams]\n    \n        if not context.executemany:\n            effective_parameters = parameters[0]\n        else:\n            effective_parameters = parameters\n    \n        if self._has_events or self.engine._has_events:\n            for fn in self.dispatch.before_cursor_execute:\n                str_statement, effective_parameters = fn(\n                    self,\n                    cursor,\n                    str_statement,\n                    effective_parameters,\n                    context,\n                    context.executemany,\n                )\n    \n        if self._echo:\n            self._log_info(str_statement)\n    \n            stats = context._get_cache_stats()\n    \n            if not self.engine.hide_parameters:\n                self._log_info(\n                    &amp;quot;[%s] %r&amp;quot;,\n                    stats,\n                    sql_util._repr_params(\n                        effective_parameters,\n                        batches=10,\n                        ismulti=context.executemany,\n                    ),\n                )\n            else:\n                self._log_info(\n                    &amp;quot;[%s] [SQL parameters hidden due to hide_parameters=True]&amp;quot;,\n                    stats,\n                )\n    \n        evt_handled: bool = False\n        try:\n            if context.execute_style is ExecuteStyle.EXECUTEMANY:\n                effective_parameters = cast(\n                    &amp;quot;_CoreMultiExecuteParams&amp;quot;, effective_parameters\n                )\n                if self.dialect._has_events:\n                    for fn in self.dialect.dispatch.do_executemany:\n                        if fn(\n                            cursor,\n                            str_statement,\n                            effective_parameters,\n                            context,\n                        ):\n                            evt_handled = True\n                            break\n                if not evt_handled:\n                    self.dialect.do_executemany(\n                        cursor,\n                        str_statement,\n                        effective_parameters,\n                        context,\n                    )\n            elif not effective_parameters and context.no_parameters:\n                if self.dialect._has_events:\n                    for fn in self.dialect.dispatch.do_execute_no_params:\n                        if fn(cursor, str_statement, context):\n                            evt_handled = True\n                            break\n                if not evt_handled:\n                    self.dialect.do_execute_no_params(\n                        cursor, str_statement, context\n                    )\n            else:\n                effective_parameters = cast(\n                    &amp;quot;_CoreSingleExecuteParams&amp;quot;, effective_parameters\n                )\n                if self.dialect._has_events:\n                    for fn in self.dialect.dispatch.do_execute:\n                        if fn(\n                            cursor,\n                            str_statement,\n                            effective_parameters,\n                            context,\n                        ):\n                            evt_handled = True\n                            break\n                if not evt_handled:\n&amp;gt;                   self.dialect.do_execute(\n                        cursor, str_statement, effective_parameters, context\n                    )\n\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1970: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py:924: in do_execute\n    cursor.execute(statement, parameters)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:153: in execute\n    result = self._query(query)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:322: in _query\n    conn.query(q)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:558: in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:822: in _read_query_result\n    result.read()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:1200: in read\n    first_packet = self.connection._read_packet()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:772: in _read_packet\n    packet.raise_for_error()\nC:\\Python310\\lib\\site-packages\\pymysql\\protocol.py:221: in raise_for_error\n    err.raise_mysql_exception(self._data)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ndata = b&amp;quot;\\xffz\\x04#42S02Table &amp;#x27;retaildwh.staging_inventory&amp;#x27; doesn&amp;#x27;t exist&amp;quot;\n\n    def raise_mysql_exception(data):\n        errno = struct.unpack(&amp;quot;&amp;lt;h&amp;quot;, data[1:3])[0]\n        errval = data[9:].decode(&amp;quot;utf-8&amp;quot;, &amp;quot;replace&amp;quot;)\n        errorclass = error_map.get(errno)\n        if errorclass is None:\n            errorclass = InternalError if errno &amp;lt; 1000 else OperationalError\n&amp;gt;       raise errorclass(errno, errval)\nE       pymysql.err.ProgrammingError: (1146, &amp;quot;Table &amp;#x27;retaildwh.staging_inventory&amp;#x27; doesn&amp;#x27;t exist&amp;quot;)\n\nC:\\Python310\\lib\\site-packages\\pymysql\\err.py:143: ProgrammingError\n\nThe above exception was the direct cause of the following exception:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x0000024ED4D6A500&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4FB7FD0&amp;gt;\n\n    def test_DataLoad_fact_inventory_Check(self, connect_to_mysql_database):\n        try:\n            logger.info(&amp;quot;test case for fact_inventory data load has started ....&amp;quot;)\n            query_expected = &amp;quot;&amp;quot;&amp;quot;select product_id,store_id,quantity_on_hand,last_updated from staging_inventory order by product_id,store_id&amp;quot;&amp;quot;&amp;quot;\n            query_actual = &amp;quot;&amp;quot;&amp;quot;select product_id,store_id,quantity_on_hand,last_updated  from fact_inventory order by product_id,store_id;&amp;quot;&amp;quot;&amp;quot;\n&amp;gt;           verify_expected_as_db_to_actual_as_db(connect_to_mysql_database, query_expected, connect_to_mysql_database,\n                                                  query_actual)\n\nTestScripts\\test_DataLoading.py:53: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nCommonUtilities\\utils.py:57: in verify_expected_as_db_to_actual_as_db\n    df_expected = pd.read_sql(query_expected, db_engine_expected)\nC:\\Python310\\lib\\site-packages\\pandas\\io\\sql.py:682: in read_sql\n    return pandas_sql.read_query(\nC:\\Python310\\lib\\site-packages\\pandas\\io\\sql.py:1776: in read_query\n    result = self.execute(sql, params)\nC:\\Python310\\lib\\site-packages\\pandas\\io\\sql.py:1599: in execute\n    return self.con.exec_driver_sql(sql, *args)\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1782: in exec_driver_sql\n    ret = self._execute_context(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1849: in _execute_context\n    return self._exec_single_context(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1989: in _exec_single_context\n    self._handle_dbapi_exception(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:2356: in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1970: in _exec_single_context\n    self.dialect.do_execute(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py:924: in do_execute\n    cursor.execute(statement, parameters)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:153: in execute\n    result = self._query(query)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:322: in _query\n    conn.query(q)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:558: in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:822: in _read_query_result\n    result.read()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:1200: in read\n    first_packet = self.connection._read_packet()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:772: in _read_packet\n    packet.raise_for_error()\nC:\\Python310\\lib\\site-packages\\pymysql\\protocol.py:221: in raise_for_error\n    err.raise_mysql_exception(self._data)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ndata = b&amp;quot;\\xffz\\x04#42S02Table &amp;#x27;retaildwh.staging_inventory&amp;#x27; doesn&amp;#x27;t exist&amp;quot;\n\n    def raise_mysql_exception(data):\n        errno = struct.unpack(&amp;quot;&amp;lt;h&amp;quot;, data[1:3])[0]\n        errval = data[9:].decode(&amp;quot;utf-8&amp;quot;, &amp;quot;replace&amp;quot;)\n        errorclass = error_map.get(errno)\n        if errorclass is None:\n            errorclass = InternalError if errno &amp;lt; 1000 else OperationalError\n&amp;gt;       raise errorclass(errno, errval)\nE       sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, &amp;quot;Table &amp;#x27;retaildwh.staging_inventory&amp;#x27; doesn&amp;#x27;t exist&amp;quot;)\nE       [SQL: select product_id,store_id,quantity_on_hand,last_updated from staging_inventory order by product_id,store_id]\nE       (Background on this error at: https://sqlalche.me/e/20/f405)\n\nC:\\Python310\\lib\\site-packages\\pymysql\\err.py:143: ProgrammingError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x0000024ED4D6A500&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED4FB7FD0&amp;gt;\n\n    def test_DataLoad_fact_inventory_Check(self, connect_to_mysql_database):\n        try:\n            logger.info(&amp;quot;test case for fact_inventory data load has started ....&amp;quot;)\n            query_expected = &amp;quot;&amp;quot;&amp;quot;select product_id,store_id,quantity_on_hand,last_updated from staging_inventory order by product_id,store_id&amp;quot;&amp;quot;&amp;quot;\n            query_actual = &amp;quot;&amp;quot;&amp;quot;select product_id,store_id,quantity_on_hand,last_updated  from fact_inventory order by product_id,store_id;&amp;quot;&amp;quot;&amp;quot;\n            verify_expected_as_db_to_actual_as_db(connect_to_mysql_database, query_expected, connect_to_mysql_database,\n                                                  query_actual)\n            logger.info(&amp;quot;test case for fact_inventory data load has completed ....&amp;quot;)\n        except Exception as e:\n            logger.error(f&amp;quot;test case for fact_inventory data load has failed{e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;Data Load failed during ETL Load process&amp;quot;)\nE           Failed: Data Load failed during ETL Load process\n\nTestScripts\\test_DataLoading.py:58: Failed\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:50 test case for fact_inventory data load has started ....\nERROR    TestScripts.test_DataLoading:test_DataLoading.py:57 test case for fact_inventory data load has failed(pymysql.err.ProgrammingError) (1146, &amp;quot;Table &amp;#x27;retaildwh.staging_inventory&amp;#x27; doesn&amp;#x27;t exist&amp;quot;)\n[SQL: select product_id,store_id,quantity_on_hand,last_updated from staging_inventory order by product_id,store_id]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_inventory_level_by_store_Check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_inventory_level_by_store_Check&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_inventory_level_by_store_Check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED65EF910&amp;gt;\ndialect = &amp;lt;sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000024ED65EFB20&amp;gt;\ncontext = &amp;lt;sqlalchemy.dialects.mysql.mysqldb.MySQLExecutionContext_mysqldb object at 0x0000024ED65EF070&amp;gt;\nstatement = &amp;#x27;select store_id,total_quantity_per_store as total_inventory  from aggregated_inventory_level order by store_id&amp;#x27;\nparameters = [immutabledict({})]\n\n    def _exec_single_context(\n        self,\n        dialect: Dialect,\n        context: ExecutionContext,\n        statement: Union[str, Compiled],\n        parameters: Optional[_AnyMultiExecuteParams],\n    ) -&amp;gt; CursorResult[Any]:\n        &amp;quot;&amp;quot;&amp;quot;continue the _execute_context() method for a single DBAPI\n        cursor.execute() or cursor.executemany() call.\n    \n        &amp;quot;&amp;quot;&amp;quot;\n        if dialect.bind_typing is BindTyping.SETINPUTSIZES:\n            generic_setinputsizes = context._prepare_set_input_sizes()\n    \n            if generic_setinputsizes:\n                try:\n                    dialect.do_set_input_sizes(\n                        context.cursor, generic_setinputsizes, context\n                    )\n                except BaseException as e:\n                    self._handle_dbapi_exception(\n                        e, str(statement), parameters, None, context\n                    )\n    \n        cursor, str_statement, parameters = (\n            context.cursor,\n            context.statement,\n            context.parameters,\n        )\n    \n        effective_parameters: Optional[_AnyExecuteParams]\n    \n        if not context.executemany:\n            effective_parameters = parameters[0]\n        else:\n            effective_parameters = parameters\n    \n        if self._has_events or self.engine._has_events:\n            for fn in self.dispatch.before_cursor_execute:\n                str_statement, effective_parameters = fn(\n                    self,\n                    cursor,\n                    str_statement,\n                    effective_parameters,\n                    context,\n                    context.executemany,\n                )\n    \n        if self._echo:\n            self._log_info(str_statement)\n    \n            stats = context._get_cache_stats()\n    \n            if not self.engine.hide_parameters:\n                self._log_info(\n                    &amp;quot;[%s] %r&amp;quot;,\n                    stats,\n                    sql_util._repr_params(\n                        effective_parameters,\n                        batches=10,\n                        ismulti=context.executemany,\n                    ),\n                )\n            else:\n                self._log_info(\n                    &amp;quot;[%s] [SQL parameters hidden due to hide_parameters=True]&amp;quot;,\n                    stats,\n                )\n    \n        evt_handled: bool = False\n        try:\n            if context.execute_style is ExecuteStyle.EXECUTEMANY:\n                effective_parameters = cast(\n                    &amp;quot;_CoreMultiExecuteParams&amp;quot;, effective_parameters\n                )\n                if self.dialect._has_events:\n                    for fn in self.dialect.dispatch.do_executemany:\n                        if fn(\n                            cursor,\n                            str_statement,\n                            effective_parameters,\n                            context,\n                        ):\n                            evt_handled = True\n                            break\n                if not evt_handled:\n                    self.dialect.do_executemany(\n                        cursor,\n                        str_statement,\n                        effective_parameters,\n                        context,\n                    )\n            elif not effective_parameters and context.no_parameters:\n                if self.dialect._has_events:\n                    for fn in self.dialect.dispatch.do_execute_no_params:\n                        if fn(cursor, str_statement, context):\n                            evt_handled = True\n                            break\n                if not evt_handled:\n                    self.dialect.do_execute_no_params(\n                        cursor, str_statement, context\n                    )\n            else:\n                effective_parameters = cast(\n                    &amp;quot;_CoreSingleExecuteParams&amp;quot;, effective_parameters\n                )\n                if self.dialect._has_events:\n                    for fn in self.dialect.dispatch.do_execute:\n                        if fn(\n                            cursor,\n                            str_statement,\n                            effective_parameters,\n                            context,\n                        ):\n                            evt_handled = True\n                            break\n                if not evt_handled:\n&amp;gt;                   self.dialect.do_execute(\n                        cursor, str_statement, effective_parameters, context\n                    )\n\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1970: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py:924: in do_execute\n    cursor.execute(statement, parameters)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:153: in execute\n    result = self._query(query)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:322: in _query\n    conn.query(q)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:558: in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:822: in _read_query_result\n    result.read()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:1200: in read\n    first_packet = self.connection._read_packet()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:772: in _read_packet\n    packet.raise_for_error()\nC:\\Python310\\lib\\site-packages\\pymysql\\protocol.py:221: in raise_for_error\n    err.raise_mysql_exception(self._data)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ndata = b&amp;quot;\\xff\\x1e\\x04#42S22Unknown column &amp;#x27;total_quantity_per_store&amp;#x27; in &amp;#x27;field list&amp;#x27;&amp;quot;\n\n    def raise_mysql_exception(data):\n        errno = struct.unpack(&amp;quot;&amp;lt;h&amp;quot;, data[1:3])[0]\n        errval = data[9:].decode(&amp;quot;utf-8&amp;quot;, &amp;quot;replace&amp;quot;)\n        errorclass = error_map.get(errno)\n        if errorclass is None:\n            errorclass = InternalError if errno &amp;lt; 1000 else OperationalError\n&amp;gt;       raise errorclass(errno, errval)\nE       pymysql.err.OperationalError: (1054, &amp;quot;Unknown column &amp;#x27;total_quantity_per_store&amp;#x27; in &amp;#x27;field list&amp;#x27;&amp;quot;)\n\nC:\\Python310\\lib\\site-packages\\pymysql\\err.py:143: OperationalError\n\nThe above exception was the direct cause of the following exception:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x0000024ED4D6A680&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED65EF910&amp;gt;\n\n    def test_DataLoad_inventory_level_by_store_Check(self, connect_to_mysql_database):\n        try:\n            logger.info(&amp;quot;test case for inventory_level_by_store data load has started ....&amp;quot;)\n            query_expected = &amp;quot;&amp;quot;&amp;quot;select store_id,total_quantity_per_store as total_inventory  from aggregated_inventory_level order by store_id&amp;quot;&amp;quot;&amp;quot;\n            query_actual = &amp;quot;&amp;quot;&amp;quot;select store_id,cast(total_inventory as Double) as total_inventory from inventory_levels_by_store order by store_id;&amp;quot;&amp;quot;&amp;quot;\n&amp;gt;           verify_expected_as_db_to_actual_as_db(connect_to_mysql_database, query_expected, connect_to_mysql_database,\n                                                  query_actual)\n\nTestScripts\\test_DataLoading.py:66: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nCommonUtilities\\utils.py:57: in verify_expected_as_db_to_actual_as_db\n    df_expected = pd.read_sql(query_expected, db_engine_expected)\nC:\\Python310\\lib\\site-packages\\pandas\\io\\sql.py:682: in read_sql\n    return pandas_sql.read_query(\nC:\\Python310\\lib\\site-packages\\pandas\\io\\sql.py:1776: in read_query\n    result = self.execute(sql, params)\nC:\\Python310\\lib\\site-packages\\pandas\\io\\sql.py:1599: in execute\n    return self.con.exec_driver_sql(sql, *args)\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1782: in exec_driver_sql\n    ret = self._execute_context(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1849: in _execute_context\n    return self._exec_single_context(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1989: in _exec_single_context\n    self._handle_dbapi_exception(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:2356: in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py:1970: in _exec_single_context\n    self.dialect.do_execute(\nC:\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py:924: in do_execute\n    cursor.execute(statement, parameters)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:153: in execute\n    result = self._query(query)\nC:\\Python310\\lib\\site-packages\\pymysql\\cursors.py:322: in _query\n    conn.query(q)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:558: in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:822: in _read_query_result\n    result.read()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:1200: in read\n    first_packet = self.connection._read_packet()\nC:\\Python310\\lib\\site-packages\\pymysql\\connections.py:772: in _read_packet\n    packet.raise_for_error()\nC:\\Python310\\lib\\site-packages\\pymysql\\protocol.py:221: in raise_for_error\n    err.raise_mysql_exception(self._data)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ndata = b&amp;quot;\\xff\\x1e\\x04#42S22Unknown column &amp;#x27;total_quantity_per_store&amp;#x27; in &amp;#x27;field list&amp;#x27;&amp;quot;\n\n    def raise_mysql_exception(data):\n        errno = struct.unpack(&amp;quot;&amp;lt;h&amp;quot;, data[1:3])[0]\n        errval = data[9:].decode(&amp;quot;utf-8&amp;quot;, &amp;quot;replace&amp;quot;)\n        errorclass = error_map.get(errno)\n        if errorclass is None:\n            errorclass = InternalError if errno &amp;lt; 1000 else OperationalError\n&amp;gt;       raise errorclass(errno, errval)\nE       sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, &amp;quot;Unknown column &amp;#x27;total_quantity_per_store&amp;#x27; in &amp;#x27;field list&amp;#x27;&amp;quot;)\nE       [SQL: select store_id,total_quantity_per_store as total_inventory  from aggregated_inventory_level order by store_id]\nE       (Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nC:\\Python310\\lib\\site-packages\\pymysql\\err.py:143: OperationalError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x0000024ED4D6A680&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000024ED65EF910&amp;gt;\n\n    def test_DataLoad_inventory_level_by_store_Check(self, connect_to_mysql_database):\n        try:\n            logger.info(&amp;quot;test case for inventory_level_by_store data load has started ....&amp;quot;)\n            query_expected = &amp;quot;&amp;quot;&amp;quot;select store_id,total_quantity_per_store as total_inventory  from aggregated_inventory_level order by store_id&amp;quot;&amp;quot;&amp;quot;\n            query_actual = &amp;quot;&amp;quot;&amp;quot;select store_id,cast(total_inventory as Double) as total_inventory from inventory_levels_by_store order by store_id;&amp;quot;&amp;quot;&amp;quot;\n            verify_expected_as_db_to_actual_as_db(connect_to_mysql_database, query_expected, connect_to_mysql_database,\n                                                  query_actual)\n            logger.info(&amp;quot;test case for inventory_level_by_store data load has completed ....&amp;quot;)\n        except Exception as e:\n            logger.error(f&amp;quot;test case for inventory_level_by_store data load has failed{e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;Data Load failed during ETL Load process&amp;quot;)\nE           Failed: Data Load failed during ETL Load process\n\nTestScripts\\test_DataLoading.py:71: Failed\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:63 test case for inventory_level_by_store data load has started ....\nERROR    TestScripts.test_DataLoading:test_DataLoading.py:70 test case for inventory_level_by_store data load has failed(pymysql.err.OperationalError) (1054, &amp;quot;Unknown column &amp;#x27;total_quantity_per_store&amp;#x27; in &amp;#x27;field list&amp;#x27;&amp;quot;)\n[SQL: select store_id,total_quantity_per_store as total_inventory  from aggregated_inventory_level order by store_id]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_file_availabilty&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Error&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_file_availabilty::setup&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Error&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_file_availabilty::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;file D:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py, line 24\n      @pytest.mark.smoke\n      @pytest.mark.DQ\n      def test_DQ_Sales_data_file_availabilty(self):\nE       fixture &amp;#x27;print_message as fixture&amp;#x27; not found\n&amp;gt;       available fixtures: cache, capfd, capfdbinary, caplog, capsys, capsysbinary, connect_to_mysql_database, connect_to_oracle_database, doctest_namespace, extra, extras, include_metadata_in_junit_xml, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory\n&amp;gt;       use &amp;#x27;pytest --fixtures [testpath]&amp;#x27; for help on them.\n\nD:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py:24\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_sales_data_file_size&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Error&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_sales_data_file_size::setup&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Error&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_sales_data_file_size::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;file D:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py, line 36\n      @pytest.mark.smoke\n      @pytest.mark.DQ\n      def test_DQ_sales_data_file_size(self):\nE       fixture &amp;#x27;print_message as fixture&amp;#x27; not found\n&amp;gt;       available fixtures: cache, capfd, capfdbinary, caplog, capsys, capsysbinary, connect_to_mysql_database, connect_to_oracle_database, doctest_namespace, extra, extras, include_metadata_in_junit_xml, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory\n&amp;gt;       use &amp;#x27;pytest --fixtures [testpath]&amp;#x27; for help on them.\n\nD:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py:36\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_duplication&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Error&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_duplication::setup&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Error&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_duplication::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;file D:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py, line 47\n      @pytest.mark.DQ\n      @pytest.mark.smoke\n      def test_DQ_Sales_data_duplication(self):\nE       fixture &amp;#x27;print_message as fixture&amp;#x27; not found\n&amp;gt;       available fixtures: cache, capfd, capfdbinary, caplog, capsys, capsysbinary, connect_to_mysql_database, connect_to_oracle_database, doctest_namespace, extra, extras, include_metadata_in_junit_xml, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory\n&amp;gt;       use &amp;#x27;pytest --fixtures [testpath]&amp;#x27; for help on them.\n\nD:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py:47\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Supplier_data_duplication_for_sales_id_column&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Error&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Supplier_data_duplication_for_sales_id_column::setup&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Error&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Supplier_data_duplication_for_sales_id_column::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;file D:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py, line 58\n      @pytest.mark.DQ\n      @pytest.mark.smoke\n      def test_DQ_Supplier_data_duplication_for_sales_id_column(self):\nE       fixture &amp;#x27;print_message as fixture&amp;#x27; not found\n&amp;gt;       available fixtures: cache, capfd, capfdbinary, caplog, capsys, capsysbinary, connect_to_mysql_database, connect_to_oracle_database, doctest_namespace, extra, extras, include_metadata_in_junit_xml, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory\n&amp;gt;       use &amp;#x27;pytest --fixtures [testpath]&amp;#x27; for help on them.\n\nD:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py:58\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_missing_value_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Error&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_missing_value_check::setup&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Error&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DQ_Sales_data_missing_value_check::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;file D:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py, line 69\n      @pytest.mark.DQ\n      @pytest.mark.smoke\n      def test_DQ_Sales_data_missing_value_check(self):\nE       fixture &amp;#x27;print_message as fixture&amp;#x27; not found\n&amp;gt;       available fixtures: cache, capfd, capfdbinary, caplog, capsys, capsysbinary, connect_to_mysql_database, connect_to_oracle_database, doctest_namespace, extra, extras, include_metadata_in_junit_xml, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory\n&amp;gt;       use &amp;#x27;pytest --fixtures [testpath]&amp;#x27; for help on them.\n\nD:\\Captsone_JanBatch_Test_Automation_Framework\\TestScripts\\test_DataQuality.py:69\n&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Filter_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Filter_check&#34;, &#34;duration&#34;: &#34;80 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Filter_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;80 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:26 Test case executin for filter transformation has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         11         101         4        15   14.0  2024-09-11   High\n2         12         102         5         9   27.0  2024-09-12    Low\n3         13         103         6        10   22.0  2024-09-13   High\n4         14         104         7         8   31.0  2024-09-14    Low\n5         15         105         4        12   11.0  2024-09-15   High\n6         16         106         5         5   23.0  2024-09-16    Low\n7         17         107         6         3   26.0  2024-09-17   High\n8         18         108         7         6   28.0  2024-09-18    Low\n9         19         109         8        11   20.0  2024-09-19   High\n10        20         110         9         9   19.5  2024-09-20    Low\n11        21         101         1        14   15.5  2024-09-21   High\n12        22         102         2         8   22.0  2024-09-22    Low\n13        23         103         3         7   18.0  2024-09-23   High\n14        24         104         4         6   25.0  2024-09-24    Low\n15        25         105         2        12   13.5  2024-09-25   High\n16        26         106         3         5   21.0  2024-09-26    Low\n17        27         107         1        10   19.0  2024-09-27   High\n18        28         108         5         6   27.0  2024-09-28    Low\n19        29         109         6         9   24.0  2024-09-29   High\n20        30         110         7         7   23.5  2024-09-30    Low\n21        31         101         4        13   14.5  2024-10-01   High\n22        32         102         5         6   29.0  2024-10-02    Low\n23        33         103         6         8   21.0  2024-10-03   High\n24        34         104         7         5   30.0  2024-10-04    Low\n25        35         105         4         7   15.0  2024-10-05   High\n26        36         106         5         3   25.0  2024-10-06    Low\n27        37         107         6        12   18.0  2024-10-07   High\n28        38         108         7         9   20.0  2024-10-08    Low\n29        39         109         8        10   22.0  2024-10-09   High\n30        40         110         9         6   26.0  2024-10-10    Low\n31        41         101         3         5   15.0  2024-10-11   High\n32        42         102         4         4   20.0  2024-10-12    Low\n33        43         103         5         9   19.0  2024-10-13   High\n34        44         104         6         7   28.0  2024-10-14    Low\n35        45         105         7        10   25.0  2024-10-15   High\n36        46         106         8         8   22.5  2024-10-16    Low\n37        47         107         9         6   24.0  2024-10-17   High\n38        48         108         1         3   27.0  2024-10-18    Low\n39        49         109         2        11   18.5  2024-10-19   High\n40        50         110         3        12   21.0  2024-10-20    Low\n41        60         110         4         9   17.0  2024-09-10    Low\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         11         101         4        15   14.0  2024-09-11   High\n2         12         102         5         9   27.0  2024-09-12    Low\n3         13         103         6        10   22.0  2024-09-13   High\n4         14         104         7         8   31.0  2024-09-14    Low\n5         15         105         4        12   11.0  2024-09-15   High\n6         16         106         5         5   23.0  2024-09-16    Low\n7         17         107         6         3   26.0  2024-09-17   High\n8         18         108         7         6   28.0  2024-09-18    Low\n9         19         109         8        11   20.0  2024-09-19   High\n10        20         110         9         9   19.5  2024-09-20    Low\n11        21         101         1        14   15.5  2024-09-21   High\n12        22         102         2         8   22.0  2024-09-22    Low\n13        23         103         3         7   18.0  2024-09-23   High\n14        24         104         4         6   25.0  2024-09-24    Low\n15        25         105         2        12   13.5  2024-09-25   High\n16        26         106         3         5   21.0  2024-09-26    Low\n17        27         107         1        10   19.0  2024-09-27   High\n18        28         108         5         6   27.0  2024-09-28    Low\n19        29         109         6         9   24.0  2024-09-29   High\n20        30         110         7         7   23.5  2024-09-30    Low\n21        31         101         4        13   14.5  2024-10-01   High\n22        32         102         5         6   29.0  2024-10-02    Low\n23        33         103         6         8   21.0  2024-10-03   High\n24        34         104         7         5   30.0  2024-10-04    Low\n25        35         105         4         7   15.0  2024-10-05   High\n26        36         106         5         3   25.0  2024-10-06    Low\n27        37         107         6        12   18.0  2024-10-07   High\n28        38         108         7         9   20.0  2024-10-08    Low\n29        39         109         8        10   22.0  2024-10-09   High\n30        40         110         9         6   26.0  2024-10-10    Low\n31        41         101         3         5   15.0  2024-10-11   High\n32        42         102         4         4   20.0  2024-10-12    Low\n33        43         103         5         9   19.0  2024-10-13   High\n34        44         104         6         7   28.0  2024-10-14    Low\n35        45         105         7        10   25.0  2024-10-15   High\n36        46         106         8         8   22.5  2024-10-16    Low\n37        47         107         9         6   24.0  2024-10-17   High\n38        48         108         1         3   27.0  2024-10-18    Low\n39        49         109         2        11   18.5  2024-10-19   High\n40        50         110         3        12   21.0  2024-10-20    Low\n41        60         110         4         9   17.0  2024-09-10    Low\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:30 Test case executin for filter transformation has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Router_Low_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Router_Low_check&#34;, &#34;duration&#34;: &#34;95 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Router_Low_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;95 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:40 Test case executin for Router_Low transformation has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         12         102         5         9   27.0  2024-09-12    Low\n2         14         104         7         8   31.0  2024-09-14    Low\n3         16         106         5         5   23.0  2024-09-16    Low\n4         18         108         7         6   28.0  2024-09-18    Low\n5         20         110         9         9   19.5  2024-09-20    Low\n6         22         102         2         8   22.0  2024-09-22    Low\n7         24         104         4         6   25.0  2024-09-24    Low\n8         26         106         3         5   21.0  2024-09-26    Low\n9         28         108         5         6   27.0  2024-09-28    Low\n10        30         110         7         7   23.5  2024-09-30    Low\n11        32         102         5         6   29.0  2024-10-02    Low\n12        34         104         7         5   30.0  2024-10-04    Low\n13        36         106         5         3   25.0  2024-10-06    Low\n14        38         108         7         9   20.0  2024-10-08    Low\n15        40         110         9         6   26.0  2024-10-10    Low\n16        42         102         4         4   20.0  2024-10-12    Low\n17        44         104         6         7   28.0  2024-10-14    Low\n18        46         106         8         8   22.5  2024-10-16    Low\n19        48         108         1         3   27.0  2024-10-18    Low\n20        50         110         3        12   21.0  2024-10-20    Low\n21        60         110         4         9   17.0  2024-09-10    Low\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         12         102         5         9   27.0  2024-09-12    Low\n2         14         104         7         8   31.0  2024-09-14    Low\n3         16         106         5         5   23.0  2024-09-16    Low\n4         18         108         7         6   28.0  2024-09-18    Low\n5         20         110         9         9   19.5  2024-09-20    Low\n6         22         102         2         8   22.0  2024-09-22    Low\n7         24         104         4         6   25.0  2024-09-24    Low\n8         26         106         3         5   21.0  2024-09-26    Low\n9         28         108         5         6   27.0  2024-09-28    Low\n10        30         110         7         7   23.5  2024-09-30    Low\n11        32         102         5         6   29.0  2024-10-02    Low\n12        34         104         7         5   30.0  2024-10-04    Low\n13        36         106         5         3   25.0  2024-10-06    Low\n14        38         108         7         9   20.0  2024-10-08    Low\n15        40         110         9         6   26.0  2024-10-10    Low\n16        42         102         4         4   20.0  2024-10-12    Low\n17        44         104         6         7   28.0  2024-10-14    Low\n18        46         106         8         8   22.5  2024-10-16    Low\n19        48         108         1         3   27.0  2024-10-18    Low\n20        50         110         3        12   21.0  2024-10-20    Low\n21        60         110         4         9   17.0  2024-09-10    Low\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:44 Test case executin for Router_Low transformation has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Router_High_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Router_High_check&#34;, &#34;duration&#34;: &#34;53 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Router_High_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;53 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:52 Test case executin for Router_High transformation has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0         11         101         4        15   14.0  2024-09-11   High\n1         13         103         6        10   22.0  2024-09-13   High\n2         15         105         4        12   11.0  2024-09-15   High\n3         17         107         6         3   26.0  2024-09-17   High\n4         19         109         8        11   20.0  2024-09-19   High\n5         21         101         1        14   15.5  2024-09-21   High\n6         23         103         3         7   18.0  2024-09-23   High\n7         25         105         2        12   13.5  2024-09-25   High\n8         27         107         1        10   19.0  2024-09-27   High\n9         29         109         6         9   24.0  2024-09-29   High\n10        31         101         4        13   14.5  2024-10-01   High\n11        33         103         6         8   21.0  2024-10-03   High\n12        35         105         4         7   15.0  2024-10-05   High\n13        37         107         6        12   18.0  2024-10-07   High\n14        39         109         8        10   22.0  2024-10-09   High\n15        41         101         3         5   15.0  2024-10-11   High\n16        43         103         5         9   19.0  2024-10-13   High\n17        45         105         7        10   25.0  2024-10-15   High\n18        47         107         9         6   24.0  2024-10-17   High\n19        49         109         2        11   18.5  2024-10-19   High\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     sales_id  product_id  store_id  quantity  price   sale_date region\n0         11         101         4        15   14.0  2024-09-11   High\n1         13         103         6        10   22.0  2024-09-13   High\n2         15         105         4        12   11.0  2024-09-15   High\n3         17         107         6         3   26.0  2024-09-17   High\n4         19         109         8        11   20.0  2024-09-19   High\n5         21         101         1        14   15.5  2024-09-21   High\n6         23         103         3         7   18.0  2024-09-23   High\n7         25         105         2        12   13.5  2024-09-25   High\n8         27         107         1        10   19.0  2024-09-27   High\n9         29         109         6         9   24.0  2024-09-29   High\n10        31         101         4        13   14.5  2024-10-01   High\n11        33         103         6         8   21.0  2024-10-03   High\n12        35         105         4         7   15.0  2024-10-05   High\n13        37         107         6        12   18.0  2024-10-07   High\n14        39         109         8        10   22.0  2024-10-09   High\n15        41         101         3         5   15.0  2024-10-11   High\n16        43         103         5         9   19.0  2024-10-13   High\n17        45         105         7        10   25.0  2024-10-15   High\n18        47         107         9         6   24.0  2024-10-17   High\n19        49         109         2        11   18.5  2024-10-19   High\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:56 Test case executin for Router_High transformation has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Aggregator_Sales_data_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Aggregator_Sales_data_check&#34;, &#34;duration&#34;: &#34;72 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Aggregator_Sales_data_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;72 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:64 Test case executin for Aggregator_Sales_data transformation has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     product_id  month  year  total_sales\n0          110      9  2024        646.0\n1          101      9  2024        427.0\n2          102      9  2024        419.0\n3          103      9  2024        346.0\n4          104      9  2024        398.0\n5          105      9  2024        294.0\n6          106      9  2024        220.0\n7          107      9  2024        268.0\n8          108      9  2024        330.0\n9          109      9  2024        436.0\n10         101     10  2024        263.5\n11         102     10  2024        254.0\n12         103     10  2024        339.0\n13         104     10  2024        346.0\n14         105     10  2024        355.0\n15         106     10  2024        255.0\n16         107     10  2024        360.0\n17         108     10  2024        261.0\n18         109     10  2024        423.5\n19         110     10  2024        408.0\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     product_id  month  year  total_sales\n0          110      9  2024        646.0\n1          101      9  2024        427.0\n2          102      9  2024        419.0\n3          103      9  2024        346.0\n4          104      9  2024        398.0\n5          105      9  2024        294.0\n6          106      9  2024        220.0\n7          107      9  2024        268.0\n8          108      9  2024        330.0\n9          109      9  2024        436.0\n10         101     10  2024        263.5\n11         102     10  2024        254.0\n12         103     10  2024        339.0\n13         104     10  2024        346.0\n14         105     10  2024        355.0\n15         106     10  2024        255.0\n16         107     10  2024        360.0\n17         108     10  2024        261.0\n18         109     10  2024        423.5\n19         110     10  2024        408.0\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:69 Test case executin for Aggregator_Sales_data transformation has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Aggregator_Inventory_Level_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Aggregator_Inventory_Level_check&#34;, &#34;duration&#34;: &#34;55 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Aggregator_Inventory_Level_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;55 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:77 Test case executin for Aggregator_Inventory_Level transformation has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:    store_id  total_inventory\n0         1            115.0\n1         2            195.0\n2         3            265.0\n3         4            220.0\n4         5            190.0\n5         6            260.0\n6         7            230.0\n7         8            270.0\n8         9            320.0\n9        10            170.0\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:    store_id  total_inventory\n0         1            115.0\n1         2            195.0\n2         3            265.0\n3         4            220.0\n4         5            190.0\n5         6            260.0\n6         7            230.0\n7         8            270.0\n8         9            320.0\n9        10            170.0\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:81 Test case executin for Aggregator_Inventory_Level transformation has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Joiner_Sales_data_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Joiner_Sales_data_check&#34;, &#34;duration&#34;: &#34;108 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DT_Joiner_Sales_data_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;108 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:30 mysql conenction is being established...\nINFO     conftest:conftest.py:32 mysql conenction is has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:89 Test case executin for Joiner_Sales_data transformation has started..\nINFO     CommonUtilities.utils:utils.py:58 The expected data is the database is:     sales_id  quantity   sale_date  price  total_sales  product_id        product_name  store_id   store_name\n0         48         3  2024-10-18   27.0         81.0         108    Philips Hue Bulb         1      Walmart\n1         27        10  2024-09-27   19.0        190.0         107      Samsung 55&amp;quot; TV         1      Walmart\n2         21        14  2024-09-21   15.5        217.0         101           iPhone 15         1      Walmart\n3         49        11  2024-10-19   18.5        203.5         109     Fitbit Charge 5         2       Target\n4         25        12  2024-09-25   13.5        162.0         105     Sony WH-1000XM5         2       Target\n5         22         8  2024-09-22   22.0        176.0         102  Samsung Galaxy S23         2       Target\n6         50        12  2024-10-20   21.0        252.0         110   Kindle Paperwhite         3     Best Buy\n7         41         5  2024-10-11   15.0         75.0         101           iPhone 15         3     Best Buy\n8         26         5  2024-09-26   21.0        105.0         106       Nike Air Zoom         3     Best Buy\n9         23         7  2024-09-23   18.0        126.0         103         Dell XPS 13         3     Best Buy\n10        60         9  2024-09-10   17.0        153.0         110   Kindle Paperwhite         4       Costco\n11        42         4  2024-10-12   20.0         80.0         102  Samsung Galaxy S23         4       Costco\n12        35         7  2024-10-05   15.0        105.0         105     Sony WH-1000XM5         4       Costco\n13        31        13  2024-10-01   14.5        188.5         101           iPhone 15         4       Costco\n14        24         6  2024-09-24   25.0        150.0         104      MacBook Pro 14         4       Costco\n15        15        12  2024-09-15   11.0        132.0         105     Sony WH-1000XM5         4       Costco\n16        11        15  2024-09-11   14.0        210.0         101           iPhone 15         4       Costco\n17        10         9  2024-09-10   17.0        153.0         110   Kindle Paperwhite         4       Costco\n18        43         9  2024-10-13   19.0        171.0         103         Dell XPS 13         5   Home Depot\n19        36         3  2024-10-06   25.0         75.0         106       Nike Air Zoom         5   Home Depot\n20        32         6  2024-10-02   29.0        174.0         102  Samsung Galaxy S23         5   Home Depot\n21        28         6  2024-09-28   27.0        162.0         108    Philips Hue Bulb         5   Home Depot\n22        16         5  2024-09-16   23.0        115.0         106       Nike Air Zoom         5   Home Depot\n23        12         9  2024-09-12   27.0        243.0         102  Samsung Galaxy S23         5   Home Depot\n24        44         7  2024-10-14   28.0        196.0         104      MacBook Pro 14         6       Lowe&amp;#x27;s\n25        37        12  2024-10-07   18.0        216.0         107      Samsung 55&amp;quot; TV         6       Lowe&amp;#x27;s\n26        33         8  2024-10-03   21.0        168.0         103         Dell XPS 13         6       Lowe&amp;#x27;s\n27        29         9  2024-09-29   24.0        216.0         109     Fitbit Charge 5         6       Lowe&amp;#x27;s\n28        17         3  2024-09-17   26.0         78.0         107      Samsung 55&amp;quot; TV         6       Lowe&amp;#x27;s\n29        13        10  2024-09-13   22.0        220.0         103         Dell XPS 13         6       Lowe&amp;#x27;s\n30        45        10  2024-10-15   25.0        250.0         105     Sony WH-1000XM5         7  Apple Store\n31        38         9  2024-10-08   20.0        180.0         108    Philips Hue Bulb         7  Apple Store\n32        34         5  2024-10-04   30.0        150.0         104      MacBook Pro 14         7  Apple Store\n33        30         7  2024-09-30   23.5        164.5         110   Kindle Paperwhite         7  Apple Store\n34        18         6  2024-09-18   28.0        168.0         108    Philips Hue Bulb         7  Apple Store\n35        14         8  2024-09-14   31.0        248.0         104      MacBook Pro 14         7  Apple Store\n36        46         8  2024-10-16   22.5        180.0         106       Nike Air Zoom         8         IKEA\n37        39        10  2024-10-09   22.0        220.0         109     Fitbit Charge 5         8         IKEA\n38        19        11  2024-09-19   20.0        220.0         109     Fitbit Charge 5         8         IKEA\n39        47         6  2024-10-17   24.0        144.0         107      Samsung 55&amp;quot; TV         9    Walgreens\n40        40         6  2024-10-10   26.0        156.0         110   Kindle Paperwhite         9    Walgreens\n41        20         9  2024-09-20   19.5        175.5         110   Kindle Paperwhite         9    Walgreens\nINFO     CommonUtilities.utils:utils.py:60 The actual data is the database is:     sales_id  quantity   sale_date  price  total_sales  product_id        product_name  store_id   store_name\n0         48         3  2024-10-18   27.0         81.0         108    Philips Hue Bulb         1      Walmart\n1         27        10  2024-09-27   19.0        190.0         107      Samsung 55&amp;quot; TV         1      Walmart\n2         21        14  2024-09-21   15.5        217.0         101           iPhone 15         1      Walmart\n3         49        11  2024-10-19   18.5        203.5         109     Fitbit Charge 5         2       Target\n4         25        12  2024-09-25   13.5        162.0         105     Sony WH-1000XM5         2       Target\n5         22         8  2024-09-22   22.0        176.0         102  Samsung Galaxy S23         2       Target\n6         50        12  2024-10-20   21.0        252.0         110   Kindle Paperwhite         3     Best Buy\n7         41         5  2024-10-11   15.0         75.0         101           iPhone 15         3     Best Buy\n8         26         5  2024-09-26   21.0        105.0         106       Nike Air Zoom         3     Best Buy\n9         23         7  2024-09-23   18.0        126.0         103         Dell XPS 13         3     Best Buy\n10        60         9  2024-09-10   17.0        153.0         110   Kindle Paperwhite         4       Costco\n11        42         4  2024-10-12   20.0         80.0         102  Samsung Galaxy S23         4       Costco\n12        35         7  2024-10-05   15.0        105.0         105     Sony WH-1000XM5         4       Costco\n13        31        13  2024-10-01   14.5        188.5         101           iPhone 15         4       Costco\n14        24         6  2024-09-24   25.0        150.0         104      MacBook Pro 14         4       Costco\n15        15        12  2024-09-15   11.0        132.0         105     Sony WH-1000XM5         4       Costco\n16        11        15  2024-09-11   14.0        210.0         101           iPhone 15         4       Costco\n17        10         9  2024-09-10   17.0        153.0         110   Kindle Paperwhite         4       Costco\n18        43         9  2024-10-13   19.0        171.0         103         Dell XPS 13         5   Home Depot\n19        36         3  2024-10-06   25.0         75.0         106       Nike Air Zoom         5   Home Depot\n20        32         6  2024-10-02   29.0        174.0         102  Samsung Galaxy S23         5   Home Depot\n21        28         6  2024-09-28   27.0        162.0         108    Philips Hue Bulb         5   Home Depot\n22        16         5  2024-09-16   23.0        115.0         106       Nike Air Zoom         5   Home Depot\n23        12         9  2024-09-12   27.0        243.0         102  Samsung Galaxy S23         5   Home Depot\n24        44         7  2024-10-14   28.0        196.0         104      MacBook Pro 14         6       Lowe&amp;#x27;s\n25        37        12  2024-10-07   18.0        216.0         107      Samsung 55&amp;quot; TV         6       Lowe&amp;#x27;s\n26        33         8  2024-10-03   21.0        168.0         103         Dell XPS 13         6       Lowe&amp;#x27;s\n27        29         9  2024-09-29   24.0        216.0         109     Fitbit Charge 5         6       Lowe&amp;#x27;s\n28        17         3  2024-09-17   26.0         78.0         107      Samsung 55&amp;quot; TV         6       Lowe&amp;#x27;s\n29        13        10  2024-09-13   22.0        220.0         103         Dell XPS 13         6       Lowe&amp;#x27;s\n30        45        10  2024-10-15   25.0        250.0         105     Sony WH-1000XM5         7  Apple Store\n31        38         9  2024-10-08   20.0        180.0         108    Philips Hue Bulb         7  Apple Store\n32        34         5  2024-10-04   30.0        150.0         104      MacBook Pro 14         7  Apple Store\n33        30         7  2024-09-30   23.5        164.5         110   Kindle Paperwhite         7  Apple Store\n34        18         6  2024-09-18   28.0        168.0         108    Philips Hue Bulb         7  Apple Store\n35        14         8  2024-09-14   31.0        248.0         104      MacBook Pro 14         7  Apple Store\n36        46         8  2024-10-16   22.5        180.0         106       Nike Air Zoom         8         IKEA\n37        39        10  2024-10-09   22.0        220.0         109     Fitbit Charge 5         8         IKEA\n38        19        11  2024-09-19   20.0        220.0         109     Fitbit Charge 5         8         IKEA\n39        47         6  2024-10-17   24.0        144.0         107      Samsung 55&amp;quot; TV         9    Walgreens\n40        40         6  2024-10-10   26.0        156.0         110   Kindle Paperwhite         9    Walgreens\n41        20         9  2024-09-20   19.5        175.5         110   Kindle Paperwhite         9    Walgreens\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:98 Test case executin for Joiner_Sales_data transformation has completed..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:35 mysql conenction is closed established...&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;testReport.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>